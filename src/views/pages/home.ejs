<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('../components/head'); %>
  </head>
  <body>
    <div class="bg-light">
      <header>
        <%- include('../components/header',{activePage:"home"}); %>
      </header>

      <main class="container mx-auto">
        <div class="relative px-6 pt-14 lg:px-8">
          <div
            class="absolute inset-x-0 -top-40 -z-10 transform-gpu overflow-hidden blur-3xl sm:-top-80"
            aria-hidden="true"
          >
            <div
              class="relative left-[calc(50%-11rem)] aspect-[1155/678] w-[36.125rem] -translate-x-1/2 rotate-[30deg] bg-gradient-to-tr from-[#ff80b5] to-[#9089fc] opacity-30 sm:left-[calc(50%-30rem)] sm:w-[72.1875rem]"
              style="
                clip-path: polygon(
                  74.1% 44.1%,
                  100% 61.6%,
                  97.5% 26.9%,
                  85.5% 0.1%,
                  80.7% 2%,
                  72.5% 32.5%,
                  60.2% 62.4%,
                  52.4% 68.1%,
                  47.5% 58.3%,
                  45.2% 34.5%,
                  27.5% 76.7%,
                  0.1% 64.9%,
                  17.9% 100%,
                  27.6% 76.8%,
                  76.1% 97.7%,
                  74.1% 44.1%
                );
              "
            ></div>
          </div>
          <div class="mx-auto max-w-2xl py-32 sm:py-48 lg:py-56">
            <div class="text-center">
              <h1
                class="text-4xl font-bold tracking-tight text-gray-900 sm:text-6xl"
              >
                A better way to share your links
              </h1>
              <br />
              <p class="mt-6 text-lg leading-8 text-gray-600">
                Get your shorten link in milliseconds and its totally free.
              </p>
              <form
                id="uidForm"
                class="mt-6 flex flex-col sm:flex-row items-center justify-center sm:gap-x-6 gap-y-2 sm:gap-y-0"
              >
                <input
                  name="uidInput"
                  class="block rounded-md w-[100%] sm:w-[50%] border-0 py-1.5 pl-5 pr-5 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"
                  placeholder="https://google.com"
                />
                <button
                  class="rounded-md bg-indigo-600 px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
                >
                  Generate Link
                  <span class="hidden sm:inline" aria-hidden="true">â†’</span>
                </button>
              </form>
              <script>
                document
                  .querySelector("#uidForm")
                  .addEventListener("submit", async (event) => {
                    event.preventDefault();
                    try {
                      const redirectUrl = new FormData(event.target).get(
                        "uidInput"
                      );
                      const urlRegex = new RegExp(
                        "^(https?:\\/\\/)?" + // protocol
                          "((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|" + // domain name
                          "((\\d{1,3}\\.){3}\\d{1,3}))" + // OR IP (v4) address
                          "(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*" + // port and path
                          "(\\?[;&a-z\\d%_.~+=-]*)?" + // query string
                          "(\\#[-a-z\\d_]*)?$",
                        "i" // fragment locator
                      );
                      if (!urlRegex.test(redirectUrl))
                        return alert("Entered Url is not valid");
                      const response = await fetch("/api/saveUrl", {
                        headers: { "Content-Type": "application/json" },
                        method: "POST",
                        body: JSON.stringify({ redirectUrl }),
                      });
                      const result = await response.json();
                      if (!response.ok) throw result;
                      console.log(result, "res");
                    } catch ({ errors, code }) {
                      const errorEntries = Object.entries(errors || {});
                      errorEntries.forEach(([type, error]) =>
                        alert(error.message)
                      );
                    }
                  });
              </script>
            </div>
          </div>
          <div
            class="absolute inset-x-0 top-[calc(100%-13rem)] -z-10 transform-gpu overflow-hidden blur-3xl sm:top-[calc(100%-30rem)]"
            aria-hidden="true"
          >
            <div
              class="relative left-[calc(50%+3rem)] aspect-[1155/678] w-[36.125rem] -translate-x-1/2 bg-gradient-to-tr from-[#ff80b5] to-[#9089fc] opacity-30 sm:left-[calc(50%+36rem)] sm:w-[72.1875rem]"
              style="
                clip-path: polygon(
                  74.1% 44.1%,
                  100% 61.6%,
                  97.5% 26.9%,
                  85.5% 0.1%,
                  80.7% 2%,
                  72.5% 32.5%,
                  60.2% 62.4%,
                  52.4% 68.1%,
                  47.5% 58.3%,
                  45.2% 34.5%,
                  27.5% 76.7%,
                  0.1% 64.9%,
                  17.9% 100%,
                  27.6% 76.8%,
                  76.1% 97.7%,
                  74.1% 44.1%
                );
              "
            ></div>
          </div>
        </div>
      </main>

      <footer><%- include('../components/footer'); %></footer>
    </div>
  </body>
</html>
